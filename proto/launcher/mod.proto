syntax = "proto3";
package launcher;
option go_package = "hyenimc/backend/gen/launcher;launcher";

service ModService {
  // Cache-based operations
  rpc ListMods(ListModsRequest) returns (ListModsResponse);
  rpc ToggleMod(ToggleModRequest) returns (ToggleModResponse);
  rpc RefreshModCache(RefreshModCacheRequest) returns (RefreshModCacheResponse);
  
  // Online operations
  rpc SearchMods(SearchModsRequest) returns (SearchModsResponse);
  rpc GetMod(GetModRequest) returns (Mod);
  rpc GetModVersions(GetModVersionsRequest) returns (GetModVersionsResponse);
  rpc InstallMod(InstallModRequest) returns (InstallModResponse);
  rpc RemoveMod(RemoveModRequest) returns (RemoveModResponse);
  rpc CheckUpdates(CheckUpdatesRequest) returns (CheckUpdatesResponse);
  rpc UpdateMod(UpdateModRequest) returns (UpdateModResponse);
}

message Mod {
  string id = 1;
  string profile_id = 2;
  string name = 3;
  string version = 4;
  string file_name = 5;
  string file_path = 6;
  string file_hash = 7;
  int64 file_size = 8;
  string mod_id = 9; // modrinth/curseforge ID
  string description = 10;
  repeated string authors = 11;
  bool enabled = 12;
  string source = 13; // modrinth|curseforge|local
  int64 last_modified = 14;
  int64 created_at = 15;
  int64 updated_at = 16;
}

// Cache operations
message ListModsRequest { 
  string profile_id = 1; 
  bool force_refresh = 2;
}
message ListModsResponse { 
  repeated Mod mods = 1; 
}

message ToggleModRequest { 
  string mod_id = 1; 
  bool enabled = 2; 
}
message ToggleModResponse { 
  bool success = 1; 
}

message RefreshModCacheRequest { 
  string profile_id = 1; 
}
message RefreshModCacheResponse { 
  int32 total_mods = 1; 
}

// Online operations
message SearchModsRequest { string query = 1; string game_version = 2; string loader_type = 3; int32 limit = 4; int32 offset = 5; }
message SearchModsResponse { repeated Mod results = 1; }

message GetModRequest { string source = 1; string id = 2; }

message GetModVersionsRequest { string source = 1; string id = 2; string game_version = 3; string loader_type = 4; }
message GetModVersionsResponse { repeated string versions = 1; }

message InstallModRequest { string profile_id = 1; string source = 2; string project_id = 3; string version_id = 4; bool required = 5; }
message InstallModResponse { Mod mod = 1; }

message RemoveModRequest { string profile_id = 1; string mod_id = 2; }
message RemoveModResponse { bool success = 1; }

message CheckUpdatesRequest { string profile_id = 1; }
message CheckUpdatesResponse { repeated ModUpdate updates = 1; }

message ModUpdate { string mod_id = 1; string current_version = 2; string latest_version = 3; string version_id = 4; bool required = 5; }

message UpdateModRequest { string profile_id = 1; string mod_id = 2; string version_id = 3; }
message UpdateModResponse { Mod mod = 1; }
