# í˜œë‹ˆì›”ë“œ ì „ìš© ëª¨ë“œ ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [ë°°í¬ ì„œë²„ ì„¤ê³„](#ë°°í¬-ì„œë²„-ì„¤ê³„)
4. [ëŸ°ì²˜ í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„](#ëŸ°ì²˜-í´ë¼ì´ì–¸íŠ¸-êµ¬í˜„)
5. [ê²Œì„ ì‹¤í–‰ ì „ ì—…ë°ì´íŠ¸ í”Œë¡œìš°](#ê²Œì„-ì‹¤í–‰-ì „-ì—…ë°ì´íŠ¸-í”Œë¡œìš°)
6. [ë°°í¬ í”„ë¡œì„¸ìŠ¤](#ë°°í¬-í”„ë¡œì„¸ìŠ¤)
7. [êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸](#êµ¬í˜„-ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

## ê°œìš”

### ëª©í‘œ
í˜œë‹ˆì›”ë“œ ì„œë²„ ì „ìš© ëª¨ë“œë“¤ì„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ì‚¬ìš©ìê°€ í•­ìƒ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•˜ë„ë¡ ë³´ì¥

### í•µì‹¬ ê¸°ëŠ¥
1. **ìë™ ì—…ë°ì´íŠ¸ ì²´í¬**: ê²Œì„ ì‹¤í–‰ ì „ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í™•ì¸
2. **ë²„ì „ ê´€ë¦¬**: ëª¨ë“œë³„ ë²„ì „ ì¶”ì  ë° ë¹„êµ
3. **ì„ íƒì  ë‹¤ìš´ë¡œë“œ**: í•„ìš”í•œ ëª¨ë“œë§Œ ë‹¤ìš´ë¡œë“œ
4. **ì•ˆì „í•œ ì—…ë°ì´íŠ¸**: ê¸°ì¡´ ëª¨ë“œ ë°±ì—… ë° ë¡¤ë°± ì§€ì›
5. **ë°°í¬ ì‹œìŠ¤í…œ**: ëª¨ë“œ ë“±ë¡ ë° ë²„ì „ ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤

### ëŒ€ìƒ ëª¨ë“œ
- HyeniHelper (í˜œë‹ˆí—¬í¼)
- ê¸°íƒ€ í˜œë‹ˆì›”ë“œ ì „ìš© ì»¤ìŠ¤í…€ ëª¨ë“œ

---

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ë°°í¬ ì„œë²„                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  REST API (ê³µê°œ)                                     â”‚   â”‚
â”‚  â”‚  - GET /api/mods/list                                â”‚   â”‚
â”‚  â”‚  - GET /api/mods/{modId}/versions                    â”‚   â”‚
â”‚  â”‚  - GET /api/mods/{modId}/latest                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Admin Panel (ì¸ì¦ í•„ìš”)                             â”‚   â”‚
â”‚  â”‚  - ëª¨ë“œ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ                                â”‚   â”‚
â”‚  â”‚  - ë²„ì „ ì—…ë¡œë“œ                                        â”‚   â”‚
â”‚  â”‚  - í†µê³„ ëŒ€ì‹œë³´ë“œ                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CDN / Storage                                       â”‚   â”‚
â”‚  â”‚  - /files/{modId}/{version}/{fileName}.jar          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†• HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HyeniMC ëŸ°ì²˜                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Custom Mod Updater Service                          â”‚   â”‚
â”‚  â”‚  - ì„œë²„ API í˜¸ì¶œ                                      â”‚   â”‚
â”‚  â”‚  - ë¡œì»¬ ëª¨ë“œ ë²„ì „ ë¹„êµ                                 â”‚   â”‚
â”‚  â”‚  - ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Game Launch Hook                                    â”‚   â”‚
â”‚  â”‚  - ì‹¤í–‰ ì „ ì—…ë°ì´íŠ¸ ì²´í¬                              â”‚   â”‚
â”‚  â”‚  - ì‚¬ìš©ì í™•ì¸ (ì„ íƒ)                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°°í¬ ì„œë²„ ì„¤ê³„

### Option 1: ê°„ë‹¨í•œ ì •ì  í˜¸ìŠ¤íŒ… + JSON (ê¶Œì¥ ì‹œì‘)

#### ì¥ì 
- ë¹ ë¥¸ êµ¬í˜„
- ë¹„ìš© ìµœì†Œí™” (GitHub Pages, Cloudflare Pages ë“± ë¬´ë£Œ)
- ìœ ì§€ë³´ìˆ˜ ê°„ë‹¨

#### êµ¬ì¡°

```
https://hyeniworld-mods.pages.dev/
â”œâ”€â”€ manifest.json              # ì „ì²´ ëª¨ë“œ ëª©ë¡
â”œâ”€â”€ mods/
â”‚   â”œâ”€â”€ hyenihelper/
â”‚   â”‚   â”œâ”€â”€ meta.json          # ë²„ì „ ì •ë³´
â”‚   â”‚   â””â”€â”€ files/
â”‚   â”‚       â”œâ”€â”€ 1.0.0/
â”‚   â”‚       â”‚   â””â”€â”€ HyeniHelper-1.0.0.jar
â”‚   â”‚       â””â”€â”€ 1.0.1/
â”‚   â”‚           â””â”€â”€ HyeniHelper-1.0.1.jar
â”‚   â””â”€â”€ custom-mod-2/
â”‚       â””â”€â”€ ...
â””â”€â”€ index.html                 # ê°„ë‹¨í•œ ë‹¤ìš´ë¡œë“œ í˜ì´ì§€
```

#### manifest.json

```json
{
  "version": "1.0",
  "lastUpdated": "2025-10-12T12:00:00Z",
  "mods": [
    {
      "id": "hyenihelper",
      "name": "HyeniHelper",
      "description": "í˜œë‹ˆì›”ë“œ ì„œë²„ ì „ìš© í—¬í¼ ëª¨ë“œ",
      "author": "HyeniWorld Team",
      "homepage": "https://hyeniworld.com",
      "latestVersion": "1.0.1",
      "gameVersions": ["1.20.1", "1.20.4"],
      "loaders": ["fabric"],
      "metaUrl": "https://hyeniworld-mods.pages.dev/mods/hyenihelper/meta.json"
    }
  ]
}
```

#### mods/hyenihelper/meta.json

```json
{
  "id": "hyenihelper",
  "name": "HyeniHelper",
  "versions": [
    {
      "version": "1.0.1",
      "gameVersions": ["1.20.1", "1.20.4"],
      "loaders": ["fabric"],
      "releaseDate": "2025-10-12T12:00:00Z",
      "changelog": "- ë²„ê·¸ ìˆ˜ì •\n- ì„±ëŠ¥ ê°œì„ ",
      "files": [
        {
          "fileName": "HyeniHelper-1.0.1.jar",
          "url": "https://hyeniworld-mods.pages.dev/mods/hyenihelper/files/1.0.1/HyeniHelper-1.0.1.jar",
          "size": 524288,
          "sha256": "abcdef1234567890..."
        }
      ]
    },
    {
      "version": "1.0.0",
      "gameVersions": ["1.20.1"],
      "loaders": ["fabric"],
      "releaseDate": "2025-10-01T00:00:00Z",
      "changelog": "- ì´ˆê¸° ë¦´ë¦¬ì¦ˆ",
      "files": [
        {
          "fileName": "HyeniHelper-1.0.0.jar",
          "url": "https://hyeniworld-mods.pages.dev/mods/hyenihelper/files/1.0.0/HyeniHelper-1.0.0.jar",
          "size": 512000,
          "sha256": "1234567890abcdef..."
        }
      ]
    }
  ]
}
```

#### ë°°í¬ ë°©ë²•

1. **GitHub Repository ìƒì„±**
   ```bash
   mkdir hyeniworld-mods
   cd hyeniworld-mods
   git init
   # ìœ„ êµ¬ì¡°ëŒ€ë¡œ íŒŒì¼ ìƒì„±
   ```

2. **Cloudflare Pages ì—°ê²°**
   - Cloudflare Dashboard â†’ Pages â†’ Create a project
   - GitHub ì—°ë™
   - Build settings: None (ì •ì  íŒŒì¼)
   - Deploy!

3. **ëª¨ë“œ ì—…ë°ì´íŠ¸ í”„ë¡œì„¸ìŠ¤**
   ```bash
   # 1. ìƒˆ ë²„ì „ ì¶”ê°€
   mkdir -p mods/hyenihelper/files/1.0.2
   cp HyeniHelper-1.0.2.jar mods/hyenihelper/files/1.0.2/
   
   # 2. meta.json ì—…ë°ì´íŠ¸ (ìƒˆ ë²„ì „ ì¶”ê°€)
   # 3. manifest.json ì—…ë°ì´íŠ¸ (latestVersion ë³€ê²½)
   
   # 4. Git push
   git add .
   git commit -m "Release HyeniHelper 1.0.2"
   git push origin main
   
   # 5. Cloudflare Pages ìë™ ë°°í¬ (1~2ë¶„)
   ```

### Option 2: ë™ì  ë°±ì—”ë“œ (ì¥ê¸°)

#### ì¥ì 
- ê´€ë¦¬ì íŒ¨ë„ ì œê³µ
- ìë™í™”ëœ ì—…ë¡œë“œ
- í†µê³„ ìˆ˜ì§‘
- ê¶Œí•œ ê´€ë¦¬

#### ê¸°ìˆ  ìŠ¤íƒ
- **Backend**: Go (Gin/Echo) ë˜ëŠ” Node.js (Express)
- **Database**: PostgreSQL ë˜ëŠ” SQLite
- **Storage**: S3 í˜¸í™˜ (Cloudflare R2, AWS S3)
- **Auth**: JWT

#### API ì—”ë“œí¬ì¸íŠ¸

```typescript
// ê³µê°œ API
GET  /api/v1/mods                      // ëª¨ë“œ ëª©ë¡
GET  /api/v1/mods/{id}                 // ëª¨ë“œ ìƒì„¸
GET  /api/v1/mods/{id}/versions        // ë²„ì „ ëª©ë¡
GET  /api/v1/mods/{id}/latest          // ìµœì‹  ë²„ì „
GET  /api/v1/download/{id}/{version}   // ë‹¤ìš´ë¡œë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸

// ê´€ë¦¬ API (ì¸ì¦ í•„ìš”)
POST   /api/v1/admin/mods              // ëª¨ë“œ ìƒì„±
PUT    /api/v1/admin/mods/{id}         // ëª¨ë“œ ìˆ˜ì •
DELETE /api/v1/admin/mods/{id}         // ëª¨ë“œ ì‚­ì œ
POST   /api/v1/admin/mods/{id}/upload  // ë²„ì „ ì—…ë¡œë“œ
```

---

## ëŸ°ì²˜ í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„

### Custom Mod Updater Service

```typescript
// src/main/services/custom-mod-updater.ts

interface CustomMod {
  id: string;
  name: string;
  latestVersion: string;
  gameVersions: string[];
  loaders: string[];
  metaUrl: string;
}

interface CustomModVersion {
  version: string;
  gameVersions: string[];
  loaders: string[];
  releaseDate: string;
  changelog: string;
  files: {
    fileName: string;
    url: string;
    size: number;
    sha256: string;
  }[];
}

export class CustomModUpdater {
  private manifestUrl = 'https://hyeniworld-mods.pages.dev/manifest.json';

  /**
   * ì‚¬ìš© ê°€ëŠ¥í•œ ì»¤ìŠ¤í…€ ëª¨ë“œ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
   */
  async listAvailableMods(): Promise<CustomMod[]> {
    try {
      const response = await fetch(this.manifestUrl);
      const data = await response.json();
      return data.mods;
    } catch (error) {
      console.error('[CustomModUpdater] Failed to fetch manifest:', error);
      return [];
    }
  }

  /**
   * íŠ¹ì • ëª¨ë“œì˜ ìµœì‹  ë²„ì „ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
   */
  async getLatestVersion(
    modId: string,
    gameVersion: string,
    loader: string
  ): Promise<CustomModVersion | null> {
    try {
      const mods = await this.listAvailableMods();
      const mod = mods.find(m => m.id === modId);
      if (!mod) return null;

      const response = await fetch(mod.metaUrl);
      const data = await response.json();

      // ê²Œì„ ë²„ì „ê³¼ ë¡œë”ê°€ í˜¸í™˜ë˜ëŠ” ìµœì‹  ë²„ì „ ì°¾ê¸°
      const compatibleVersions = data.versions.filter((v: CustomModVersion) =>
        v.gameVersions.includes(gameVersion) &&
        v.loaders.includes(loader)
      );

      if (compatibleVersions.length === 0) return null;

      // ë²„ì „ ë¹„êµ (semver)
      compatibleVersions.sort((a, b) => 
        this.compareVersions(b.version, a.version)
      );

      return compatibleVersions[0];
    } catch (error) {
      console.error(`[CustomModUpdater] Failed to get latest version for ${modId}:`, error);
      return null;
    }
  }

  /**
   * í”„ë¡œí•„ì— ì„¤ì¹˜ëœ ì»¤ìŠ¤í…€ ëª¨ë“œ í™•ì¸
   */
  async checkInstalledCustomMods(
    profile: Profile
  ): Promise<{ modId: string; currentVersion: string; fileName: string }[]> {
    const modsDir = path.join(profile.gameDirectory, 'mods');
    const installedMods: { modId: string; currentVersion: string; fileName: string }[] = [];

    try {
      const files = await fs.readdir(modsDir);
      const mods = await this.listAvailableMods();

      for (const mod of mods) {
        // íŒŒì¼ëª…ì— ëª¨ë“œ IDê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        const modFile = files.find(file => 
          file.toLowerCase().includes(mod.id.toLowerCase()) &&
          file.endsWith('.jar')
        );

        if (modFile) {
          // íŒŒì¼ëª…ì—ì„œ ë²„ì „ ì¶”ì¶œ (ì˜ˆ: HyeniHelper-1.0.1.jar â†’ 1.0.1)
          const versionMatch = modFile.match(/(\d+\.\d+\.\d+)/);
          const currentVersion = versionMatch ? versionMatch[1] : 'unknown';

          installedMods.push({
            modId: mod.id,
            currentVersion,
            fileName: modFile,
          });
        }
      }
    } catch (error) {
      console.error('[CustomModUpdater] Failed to check installed mods:', error);
    }

    return installedMods;
  }

  /**
   * ì—…ë°ì´íŠ¸ ê°€ëŠ¥í•œ ëª¨ë“œ ì°¾ê¸°
   */
  async checkForUpdates(profile: Profile): Promise<{
    modId: string;
    name: string;
    currentVersion: string;
    latestVersion: string;
    downloadUrl: string;
    fileName: string;
    size: number;
    sha256: string;
    changelog: string;
  }[]> {
    const installedMods = await this.checkInstalledCustomMods(profile);
    const updates = [];

    for (const installed of installedMods) {
      const latest = await this.getLatestVersion(
        installed.modId,
        profile.gameVersion,
        profile.loaderType
      );

      if (!latest) continue;

      if (this.compareVersions(latest.version, installed.currentVersion) > 0) {
        const mods = await this.listAvailableMods();
        const modInfo = mods.find(m => m.id === installed.modId);

        updates.push({
          modId: installed.modId,
          name: modInfo?.name || installed.modId,
          currentVersion: installed.currentVersion,
          latestVersion: latest.version,
          downloadUrl: latest.files[0].url,
          fileName: latest.files[0].fileName,
          size: latest.files[0].size,
          sha256: latest.files[0].sha256,
          changelog: latest.changelog,
        });
      }
    }

    return updates;
  }

  /**
   * ëª¨ë“œ ì—…ë°ì´íŠ¸ ì‹¤í–‰
   */
  async updateMod(
    profile: Profile,
    modId: string,
    update: {
      downloadUrl: string;
      fileName: string;
      sha256: string;
      currentFileName: string;
    }
  ): Promise<void> {
    const modsDir = path.join(profile.gameDirectory, 'mods');
    const oldFilePath = path.join(modsDir, update.currentFileName);
    const newFilePath = path.join(modsDir, update.fileName);
    const backupPath = path.join(modsDir, `${update.currentFileName}.backup`);

    try {
      // 1. ê¸°ì¡´ íŒŒì¼ ë°±ì—…
      if (await this.fileExists(oldFilePath)) {
        await fs.rename(oldFilePath, backupPath);
      }

      // 2. ìƒˆ ë²„ì „ ë‹¤ìš´ë¡œë“œ
      await this.downloadFile(update.downloadUrl, newFilePath, update.sha256);

      // 3. ë°±ì—… íŒŒì¼ ì‚­ì œ
      if (await this.fileExists(backupPath)) {
        await fs.unlink(backupPath);
      }

      console.log(`[CustomModUpdater] Updated ${modId} successfully`);
    } catch (error) {
      console.error(`[CustomModUpdater] Update failed for ${modId}:`, error);

      // 4. ë¡¤ë°±
      if (await this.fileExists(backupPath)) {
        if (await this.fileExists(newFilePath)) {
          await fs.unlink(newFilePath);
        }
        await fs.rename(backupPath, oldFilePath);
      }

      throw error;
    }
  }

  /**
   * íŒŒì¼ ë‹¤ìš´ë¡œë“œ with SHA256 ê²€ì¦
   */
  private async downloadFile(url: string, dest: string, expectedSha256: string): Promise<void> {
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`Download failed: ${response.statusText}`);
    }

    const buffer = await response.arrayBuffer();
    await fs.writeFile(dest, Buffer.from(buffer));

    // SHA256 ê²€ì¦
    const hash = crypto.createHash('sha256');
    const fileBuffer = await fs.readFile(dest);
    hash.update(fileBuffer);
    const actualSha256 = hash.digest('hex');

    if (actualSha256 !== expectedSha256) {
      await fs.unlink(dest);
      throw new Error('SHA256 checksum mismatch');
    }
  }

  /**
   * ë²„ì „ ë¹„êµ (semver)
   */
  private compareVersions(v1: string, v2: string): number {
    const parts1 = v1.split('.').map(Number);
    const parts2 = v2.split('.').map(Number);

    for (let i = 0; i < Math.max(parts1.length, parts2.length); i++) {
      const a = parts1[i] || 0;
      const b = parts2[i] || 0;
      if (a > b) return 1;
      if (a < b) return -1;
    }

    return 0;
  }

  private async fileExists(path: string): Promise<boolean> {
    try {
      await fs.access(path);
      return true;
    } catch {
      return false;
    }
  }
}
```

---

## ê²Œì„ ì‹¤í–‰ ì „ ì—…ë°ì´íŠ¸ í”Œë¡œìš°

### êµ¬í˜„

```typescript
// src/main/ipc/profile.ts (launch í•¸ë“¤ëŸ¬ ìˆ˜ì •)

ipcMain.handle(IPC_CHANNELS.PROFILE_LAUNCH, async (event, profileId: string) => {
  try {
    const profile = await grpcClient.profile.getProfile({ id: profileId });
    
    // 1. ì»¤ìŠ¤í…€ ëª¨ë“œ ì—…ë°ì´íŠ¸ ì²´í¬
    if (profile.serverAddress) {
      console.log('[Launch] Checking custom mod updates...');
      
      const updater = new CustomModUpdater();
      const updates = await updater.checkForUpdates(profile);
      
      if (updates.length > 0) {
        console.log(`[Launch] Found ${updates.length} custom mod updates`);
        
        // UIì— ì—…ë°ì´íŠ¸ ì•Œë¦¼
        const shouldUpdate = await new Promise<boolean>((resolve) => {
          event.sender.send('custom-mod-updates-available', {
            profileId,
            updates,
          });
          
          // ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
          ipcMain.once(`custom-mod-update-response-${profileId}`, (_, response) => {
            resolve(response.update);
          });
        });
        
        if (shouldUpdate) {
          // ì—…ë°ì´íŠ¸ ì‹¤í–‰
          for (const update of updates) {
            try {
              await updater.updateMod(profile, update.modId, update);
              event.sender.send('custom-mod-update-progress', {
                modId: update.modId,
                status: 'success',
              });
            } catch (error) {
              event.sender.send('custom-mod-update-progress', {
                modId: update.modId,
                status: 'failed',
                error: error.message,
              });
            }
          }
        }
      }
    }
    
    // 2. ê²Œì„ ì‹¤í–‰
    const gameLauncher = new GameLauncher();
    await gameLauncher.launch(profile);
    
    return { success: true };
  } catch (error) {
    console.error('[Launch] Failed:', error);
    throw error;
  }
});
```

### UI: ì—…ë°ì´íŠ¸ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸

```typescript
// src/renderer/components/modals/CustomModUpdateModal.tsx

interface Props {
  profileId: string;
  updates: CustomModUpdate[];
  onConfirm: (update: boolean) => void;
}

export function CustomModUpdateModal({ profileId, updates, onConfirm }: Props) {
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <div className="bg-gray-800 rounded-lg p-6 max-w-md w-full">
        <h2 className="text-xl font-bold mb-4">ğŸ”„ ëª¨ë“œ ì—…ë°ì´íŠ¸ ê°€ëŠ¥</h2>
        
        <p className="text-sm text-gray-300 mb-4">
          í˜œë‹ˆì›”ë“œ ì „ìš© ëª¨ë“œì˜ ìƒˆ ë²„ì „ì´ ìˆìŠµë‹ˆë‹¤.
        </p>

        <div className="space-y-3 mb-6">
          {updates.map(update => (
            <div key={update.modId} className="bg-gray-700 rounded p-3">
              <div className="flex items-center justify-between mb-2">
                <span className="font-semibold">{update.name}</span>
                <span className="text-xs bg-green-600 px-2 py-1 rounded">
                  NEW
                </span>
              </div>
              <div className="text-sm text-gray-400">
                {update.currentVersion} â†’ {update.latestVersion}
              </div>
              {update.changelog && (
                <details className="mt-2">
                  <summary className="text-xs cursor-pointer text-primary">
                    ë³€ê²½ì‚¬í•­ ë³´ê¸°
                  </summary>
                  <pre className="text-xs text-gray-400 mt-1 whitespace-pre-wrap">
                    {update.changelog}
                  </pre>
                </details>
              )}
            </div>
          ))}
        </div>

        <div className="flex gap-3">
          <button
            onClick={() => onConfirm(false)}
            className="flex-1 py-2 bg-gray-700 rounded hover:bg-gray-600"
          >
            ë‚˜ì¤‘ì—
          </button>
          <button
            onClick={() => onConfirm(true)}
            className="flex-1 py-2 bg-primary rounded hover:bg-primary-dark font-semibold"
          >
            ì—…ë°ì´íŠ¸ ë° ì‹¤í–‰
          </button>
        </div>
      </div>
    </div>
  );
}
```

---

## ë°°í¬ í”„ë¡œì„¸ìŠ¤

### ì´ˆê¸° ì„¤ì • (1íšŒ)

```bash
# 1. GitHub Repository ìƒì„±
gh repo create hyeniworld-mods --public

# 2. ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
mkdir -p mods/hyenihelper/files/1.0.0
touch manifest.json
touch mods/hyenihelper/meta.json

# 3. Cloudflare Pages ì—°ê²°
# - Cloudflare Dashboardì—ì„œ ì„¤ì •
# - GitHub ì—°ë™
# - Branch: main
# - Build command: (none)
# - Build output directory: /
```

### ìƒˆ ëª¨ë“œ ë²„ì „ ë°°í¬

```bash
#!/bin/bash
# scripts/deploy-mod.sh

MOD_ID=$1
VERSION=$2
JAR_FILE=$3

if [ -z "$MOD_ID" ] || [ -z "$VERSION" ] || [ -z "$JAR_FILE" ]; then
  echo "Usage: ./deploy-mod.sh <mod-id> <version> <jar-file>"
  exit 1
fi

# 1. íŒŒì¼ ë³µì‚¬
mkdir -p "mods/$MOD_ID/files/$VERSION"
cp "$JAR_FILE" "mods/$MOD_ID/files/$VERSION/"

# 2. SHA256 ê³„ì‚°
SHA256=$(sha256sum "$JAR_FILE" | awk '{print $1}')
FILE_SIZE=$(stat -f%z "$JAR_FILE" 2>/dev/null || stat -c%s "$JAR_FILE")
FILE_NAME=$(basename "$JAR_FILE")

# 3. meta.json ì—…ë°ì´íŠ¸
# (ìˆ˜ë™ìœ¼ë¡œ í¸ì§‘í•˜ê±°ë‚˜ jq ì‚¬ìš©)

# 4. Git commit & push
git add .
git commit -m "Release $MOD_ID $VERSION"
git push origin main

echo "âœ… Deployed $MOD_ID $VERSION"
echo "SHA256: $SHA256"
```

---

## êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Week 1: ë°°í¬ ì¸í”„ë¼ (ì™¸ë¶€ ì‘ì—…)
- [ ] GitHub Repository ìƒì„±
- [ ] ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ì •
- [ ] `manifest.json` ì‘ì„±
- [ ] ì²« ë²ˆì§¸ ëª¨ë“œ `meta.json` ì‘ì„±
- [ ] Cloudflare Pages ì—°ê²°
- [ ] ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [ ] í…ŒìŠ¤íŠ¸ ë°°í¬

### Week 2: ëŸ°ì²˜ êµ¬í˜„ (4ì¼)
- [ ] `CustomModUpdater` ì„œë¹„ìŠ¤ êµ¬í˜„
- [ ] IPC Handler ìˆ˜ì • (launch ì „ ì²´í¬)
- [ ] `CustomModUpdateModal` ì»´í¬ë„ŒíŠ¸
- [ ] ì—…ë°ì´íŠ¸ ì§„í–‰ë¥  í‘œì‹œ
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡¤ë°±
- [ ] í†µí•© í…ŒìŠ¤íŠ¸

### Week 3: ì„ íƒ ê¸°ëŠ¥ (2ì¼)
- [ ] ìë™ ì—…ë°ì´íŠ¸ ì˜µì…˜ (ì„¤ì •)
- [ ] ì—…ë°ì´íŠ¸ íˆìŠ¤í† ë¦¬ ë¡œê·¸
- [ ] ê´€ë¦¬ì íŒ¨ë„ (Option 2)

---

## SPA (Single Packet Authorization) ì¶”ê°€ êµ¬í˜„

### ê°œìš”
ê²Œì„ ì‹¤í–‰ ì‹œ ì„œë²„ì— UDP íŒ¨í‚·ì„ ì „ì†¡í•˜ì—¬ ë³´ì•ˆ ê°•í™”

### êµ¬í˜„

```typescript
// src/main/services/spa-sender.ts
import dgram from 'dgram';

export class SPASender {
  /**
   * SPA íŒ¨í‚· ì „ì†¡
   */
  async sendSPA(
    serverAddress: string,
    port: number,
    secret: string
  ): Promise<void> {
    return new Promise((resolve, reject) => {
      const client = dgram.createSocket('udp4');
      
      // íŒ¨í‚· ìƒì„± (ì„œë²„ì™€ ì•½ì†ëœ í˜•ì‹)
      const timestamp = Date.now();
      const payload = JSON.stringify({
        secret,
        timestamp,
        version: '1.0',
      });
      
      const message = Buffer.from(payload);
      
      client.send(message, port, serverAddress, (error) => {
        if (error) {
          client.close();
          reject(error);
        } else {
          console.log(`[SPA] Packet sent to ${serverAddress}:${port}`);
          client.close();
          resolve();
        }
      });
      
      // íƒ€ì„ì•„ì›ƒ
      setTimeout(() => {
        client.close();
        reject(new Error('SPA timeout'));
      }, 5000);
    });
  }
}

// Launch ì‹œ í˜¸ì¶œ
if (profile.spaEnabled && profile.serverAddress) {
  const spa = new SPASender();
  await spa.sendSPA(profile.serverAddress, 12345, 'shared-secret');
}
```

---

**ì‘ì„±ì¼**: 2025-10-12  
**ìš°ì„ ìˆœìœ„**: â­â­â­ (ì¤‘ê¸° - ì™¸ë¶€ ì¸í”„ë¼ í•„ìš”)  
**ì˜ˆìƒ ì‹œê°„**: 1ì£¼ (ëŸ°ì²˜) + ì™¸ë¶€ ì¸í”„ë¼ êµ¬ì¶•
